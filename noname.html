<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dearest Megha Babbyy ‚ù§Ô∏è</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Tone.js for music -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Custom styles for the romantic effects */
        /* Import the custom fonts */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Inter:wght@300;400;700&family=Great+Vibes&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scroll from floating elements */
        }
        
        .apology-card {
            box-shadow: 0 20px 50px rgba(255, 105, 180, 0.4);
        }

        /* Title specific style using Great Vibes */
        .page-title {
            font-family: 'Great Vibes', cursive;
            letter-spacing: 0.1rem;
            line-height: 1.2;
        }

        /* --- Custom Carousel Styles --- */
        .carousel-container {
            position: relative;
            overflow: hidden;
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .carousel-track {
            display: flex;
            transition: transform 0.4s ease-in-out;
            touch-action: pan-y; /* Allows vertical scrolling on touch devices while handling horizontal swipe */
        }
        
        .carousel-slide {
            flex: 0 0 100%; /* Each slide takes full width */
            width: 100%;
        }

        /* Enforcing the 9:16 aspect ratio for the image container */
        .image-wrapper {
            width: 100%;
            /* 9:16 is 177.77% height of width. */
            padding-top: 177.77%; 
            position: relative;
        }

        .image-wrapper img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* --- Floating Hearts and Butterflies Animation --- */
        .floating-element {
            position: absolute;
            animation: float-up linear infinite;
            pointer-events: none;
            z-index: 10;
        }

        .butterfly {
            animation: float-up linear infinite, flutter 2s ease-in-out infinite;
        }
        
        @keyframes float-up {
            0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translateY(-10vh) scale(1); opacity: 0; }
        }

        @keyframes flutter {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Specific styles for the apology text */
        #apology-text {
            font-family: 'Dancing Script', cursive;
        }
    </style>
</head>

<body class="min-h-screen bg-pink-50 flex flex-col items-center justify-center p-4">

    <!-- Title and main container -->
    <div class="w-full max-w-4xl mx-auto py-12">
        <header class="text-center mb-10">
            <h1 class="page-title text-5xl md:text-7xl font-bold text-pink-700 sparkle-glow">
                My Dearest Megha Babbyy
            </h1>
        </header>

        <!-- Apology Card -->
        <div class="apology-card bg-white p-6 sm:p-10 rounded-3xl shadow-2xl transition duration-500 hover:shadow-pink-400/70">

            <!-- Apology Text Section -->
            <section class="mb-8 text-center">
                <p id="apology-text" class="text-3xl md:text-4xl text-gray-700 leading-relaxed italic">
                    My dearest, there are no words that can truly express how sorry I am for hurting you. 
                    Knowing I caused you pain is the worst feeling in the world. 
                    You are the light in my life, and I cherish every moment we share. 
                    Please know that I am committed to making things right and earning back your beautiful trust. 
                    I love you more than anything.
                </p>
            </section>

            <!-- Music Button -->
            <div class="flex justify-center mb-10">
                <button id="playMusicBtn" 
                        class="px-8 py-3 bg-pink-500 text-white font-bold rounded-full shadow-lg hover:bg-pink-600 transition duration-300 transform hover:scale-105 active:scale-95 sparkle-glow text-lg">
                    <span id="buttonText">Click to Play Our Song üéµ</span>
                </button>
            </div>
            
            <!-- Photo Carousel Section (9:16 Aspect Ratio) -->
            <section class="mb-8">
                <h2 class="text-2xl font-bold text-center text-pink-500 mb-6">Swipe to See Our 8 Precious Memories ‚ù§Ô∏è</h2>
                <div class="flex justify-center">
                    <div class="carousel-container w-full max-w-xs sm:max-w-sm lg:max-w-md">
                        <div id="carouselTrack" class="carousel-track">
                            <!-- Slides 1 through 8 (9:16 Ratio) - Using the provided files -->
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[0]" 
                                         alt="A cherished memory of us hugging on the trail" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/FFB6C1/A0522D?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[1]" 
                                         alt="A fun Snapchat-style selfie with cute filters" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/F08080/FFFFFF?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[2]" 
                                         alt="A sweet picture of us holding roses at a cafe" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/FFA07A/000000?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[3]" 
                                         alt="A serious but loving look between us outdoors" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/E6E6FA/8A2BE2?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[4]" 
                                         alt="A beautiful kiss with a mountain background" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/FFDAB9/B0C4DE?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[5]" 
                                         alt="A cute photo of Megha covering her eyes" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/ADD8E6/4682B4?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[6]" 
                                         alt="A romantic shot under a sunny trellis holding flowers" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/F0FFF0/3CB371?text=Image+Load+Failed';">
                                </div>
                            </div>
                            <div class="carousel-slide">
                                <div class="image-wrapper">
                                    <img src="__image_references__[7]" 
                                         alt="A powerful black and white hug showing our bond" 
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x711/FFE4B5/8B4513?text=Image+Load+Failed';">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Navigation Dots -->
                        <div id="dotsContainer" class="absolute bottom-4 left-0 right-0 flex justify-center space-x-2 p-2">
                            <!-- Dots will be inserted here by JavaScript -->
                        </div>

                        <!-- Swipe Indicator -->
                        <div class="absolute top-1/2 left-0 right-0 flex justify-between px-3 transform -translate-y-1/2">
                            <span class="text-white text-3xl opacity-75 hidden md:block select-none cursor-pointer" onclick="moveSlide(-1)">&#10094;</span>
                            <span class="text-white text-3xl opacity-75 hidden md:block select-none cursor-pointer" onclick="moveSlide(1)">&#10095;</span>
                        </div>
                    </div>
                </div>
                <p class="text-center text-sm text-gray-500 mt-2">Tap/Click the arrows or swipe left/right on mobile!</p>
            </section>
        </div>
        
        <!-- Footer / Signature -->
        <footer class="text-center mt-8 text-gray-500 text-lg italic">
            Forever yours, <span class="font-semibold text-pink-600">Your Name</span>
        </footer>

    </div>

    <!-- Container for floating hearts and butterflies -->
    <div id="floating-container"></div>

    <script>
        // Use an IIFE for encapsulation
        (function() {
            // --- CAROUSEL LOGIC ---
            const track = document.getElementById('carouselTrack');
            // Dynamically calculate slides based on content
            const slides = document.querySelectorAll('.carousel-slide');
            const dotsContainer = document.getElementById('dotsContainer');
            let currentIndex = 0;
            let startX = 0;
            let endX = 0;
            const threshold = 50; // Minimum distance to swipe

            // Create navigation dots dynamically based on number of slides (8 total)
            slides.forEach((_, index) => {
                const dot = document.createElement('span');
                dot.classList.add('w-3', 'h-3', 'rounded-full', 'bg-white', 'bg-opacity-50', 'cursor-pointer', 'transition', 'duration-300');
                dot.addEventListener('click', () => {
                    currentIndex = index;
                    updateCarousel();
                });
                dotsContainer.appendChild(dot);
            });

            function updateCarousel() {
                // Update track position
                const offset = -currentIndex * 100;
                track.style.transform = `translateX(${offset}%)`;

                // Update dots appearance
                document.querySelectorAll('#dotsContainer span').forEach((dot, index) => {
                    dot.classList.remove('bg-opacity-100', 'bg-pink-500');
                    dot.classList.add('bg-opacity-50', 'bg-white');
                    if (index === currentIndex) {
                        dot.classList.add('bg-opacity-100', 'bg-pink-500');
                        dot.classList.remove('bg-opacity-50', 'bg-white');
                    }
                });
            }

            function moveSlide(direction) {
                currentIndex += direction;
                if (currentIndex < 0) {
                    currentIndex = slides.length - 1;
                } else if (currentIndex >= slides.length) {
                    currentIndex = 0;
                }
                updateCarousel();
            }

            // Initial setup
            updateCarousel();
            window.moveSlide = moveSlide; // Expose to global scope for arrow clicks

            // Touch/Swipe Logic
            function handleStart(event) {
                startX = event.touches ? event.touches[0].clientX : event.clientX;
                track.style.transition = 'none'; // Disable transition during drag
            }

            function handleMove(event) {
                if (!startX) return;
                endX = event.touches ? event.touches[0].clientX : event.clientX;
                const deltaX = endX - startX;
                const currentOffset = -currentIndex * track.offsetWidth;
                track.style.transform = `translateX(${currentOffset + deltaX}px)`;
                event.preventDefault(); // Prevent scrolling while swiping horizontally
            }

            function handleEnd(event) {
                track.style.transition = 'transform 0.4s ease-in-out'; // Re-enable transition
                if (Math.abs(endX - startX) > threshold) {
                    if (endX < startX) {
                        // Swipe left (next slide)
                        moveSlide(1);
                    } else if (endX > startX) {
                        // Swipe right (previous slide)
                        moveSlide(-1);
                    }
                } else {
                    // Snap back if swipe distance is too small
                    updateCarousel();
                }
                startX = 0;
                endX = 0;
            }

            // Add mouse/touch event listeners
            track.addEventListener('mousedown', handleStart);
            track.addEventListener('mousemove', handleMove);
            track.addEventListener('mouseup', handleEnd);
            track.addEventListener('mouseleave', handleEnd);

            track.addEventListener('touchstart', handleStart);
            track.addEventListener('touchmove', handleMove);
            track.addEventListener('touchend', handleEnd);


            // --- TONE.JS MUSIC SETUP ---
            const playMusicBtn = document.getElementById('playMusicBtn');
            const buttonText = document.getElementById('buttonText');
            let isMusicPlaying = false;
            let synth, loop;

            function setupMusic() {
                synth = new Tone.PolySynth(Tone.Synth, {
                    oscillator: { type: "sine" },
                    envelope: { attack: 0.02, decay: 0.1, sustain: 0.3, release: 1.5 },
                    volume: -10
                }).toDestination();

                const chords = [
                    ["C4", "E4", "G4", "B4"],
                    ["F4", "A4", "C5", "E5"],
                    ["A3", "C4", "E4", "G4"],
                    ["G3", "B3", "D4", "F#4"]
                ];

                let chordIndex = 0;
                loop = new Tone.Loop(time => {
                    const currentChord = chords[chordIndex % chords.length];
                    synth.triggerAttackRelease(currentChord, "2n", time);
                    chordIndex++;
                }, "2n").start(0);
                
                Tone.Transport.bpm.value = 60;
            }

            async function startMusic() {
                if (isMusicPlaying) return;
                try {
                    await Tone.start();
                    setupMusic();
                    Tone.Transport.start();
                    isMusicPlaying = true;
                    buttonText.textContent = "Music is Playing üé∂ (Click to Pause)";
                    playMusicBtn.classList.remove('bg-pink-500');
                    playMusicBtn.classList.add('bg-green-500');
                } catch (error) {
                    console.error("Error starting audio context:", error);
                }
            }

            function stopMusic() {
                if (!isMusicPlaying) return;
                Tone.Transport.stop();
                if (loop) loop.dispose();
                if (synth) synth.dispose();
                isMusicPlaying = false;
                buttonText.textContent = "Click to Play Our Song üéµ";
                playMusicBtn.classList.remove('bg-green-500');
                playMusicBtn.classList.add('bg-pink-500');
            }

            playMusicBtn.addEventListener('click', () => {
                if (!isMusicPlaying) {
                    startMusic();
                } else {
                    stopMusic();
                }
            });


            // --- FLOATING EFFECTS (Hearts, Butterflies, Sparkles) ---
            const floatingContainer = document.getElementById('floating-container');
            const elements = [
                { content: 'üíñ', type: 'heart', size: 'text-2xl' },
                { content: 'ü¶ã', type: 'butterfly', size: 'text-lg' },
                { content: '‚ú®', type: 'sparkle', size: 'text-xl' },
                { content: '‚ù§Ô∏è', type: 'heart', size: 'text-3xl' },
                { content: 'üå∏', type: 'butterfly', size: 'text-xl' },
            ];

            function createFloatingElement() {
                const elementData = elements[Math.floor(Math.random() * elements.length)];
                const element = document.createElement('div');
                element.innerHTML = elementData.content;
                element.className = \`floating-element \${elementData.size} \${elementData.type}\`;
                
                element.style.left = \`\${Math.random() * 100}vw\`;
                
                const duration = 10 + Math.random() * 10;
                element.style.animationDuration = \`\${duration}s\`;
                element.style.animationDelay = \`\${-Math.random() * 10}s\`;

                floatingContainer.appendChild(element);

                // Remove element after it floats off screen
                element.addEventListener('animationend', () => {
                    element.remove();
                    createFloatingElement();
                });
            }

            // Generate 20 floating elements
            for (let i = 0; i < 20; i++) {
                createFloatingElement();
            }

        })();
    </script>
</body>
</html>